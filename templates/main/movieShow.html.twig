{% extends "base.html.twig" %}

{% block title %}Bienvenue sur la page du film {{ this_movie_info.title }} {% endblock %}

{% block nav_active_movies %}active{% endblock %}

{% block body %}
<div class="container bg-lighttt pt-5">

    <div class="row mb-2">

        <div class="col">

            <div
                class="row g-0 borderrr rrrounded overflow-hidden flex-md-row align-items-start mb-4 shadow-smmm position-relative">
                <div class="col-4 movie__poster img-thumbnail"
                style="background-image: url('{{ this_movie_info.poster }}');">
                <img src="{{ asset('images/poster-placeholder.png') }}" class="img-fluid">
            </div>

                <div class="col-8 p-4 d-flex flex-column position-static bg-light">
                    <a href="" class="movie__favorite fs-1 my-2 mx-3 link-danger"><i class="bi bi-bookmark-plus"></i></a>
                    <strong class="d-inline-block mb-2 text-{% if this_movie_info.type == 'Film' %}primary{% else %}success{% endif %}">{{ this_movie_info.type }}</strong>
                    <h3 class="mb-1">{{ this_movie_info.title }}</h3>
                    <div class="mb-1 text-muted">{{ this_movie_info.duration }} min</div>
                    <p>
                        {% for genre in this_movie_info.genres %}
                        <span class="badge bg-warning text-dark">{{ genre.name }}</span>
                        {% endfor %}
                    </p>
                    <p>{{ this_movie_info.synopsis }}</p>
                    <div class="d-flex" style="color: orange;">
                        {% set k = this_movie_info.rating %}
                        {% for i in range(1, this_movie_info.rating|round(0, 'floor')) %}
                            <i class="bi bi-star-fill"></i>
                            {% set k = k-1 %}
                        {% endfor %}
                        {% if k>0 %}
                        <i class="bi bi-star-half"></i>
                        {% endif %}
                        <span class="ps-1">{{ this_movie_info.rating }}</span>
                    </div>
                    {% if this_movie_info.type != 'Film' %}
                    <h2>{{ this_movie_info.seasons|length }} Saisons</h2>
                        <ul class="list-unstyled">
                            {% for key, season in this_movie_info.seasons %}
                            <li><span class="badge bg-danger fs-6 mb-2">Saison {{ season.number }}</span><small class="ms-1">({{ season.episodesNumber }} épisodes)</small></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    <dl class="row">
                        <dt class="col-sm-12">Avec</dt>
                        <dd class="col-sm-12">
                            {% for key, actor in casting %}
                            {{ actor.person.firstname }} {{ actor.person.lastname }} ({{ actor.role }})<br />
                            {% endfor %}
                        </dd>
                        <dt class="col-sm-12">Pays</dt>
                        <dd class="col-sm-12">USA</dd>
                        <dt class="col-sm-12">Année</dt>
                        <dd class="col-sm-12">{{ this_movie_info.releaseDate|date('d-m-Y') }}</dd>
                    </dl>
                    <a href="{{ path('review', {id: this_movie_info.id}) }}" class="btn btn-primary">Déposer un avis</a>
                </div>
            </div>

        </div>

    </div>

    <h3>Liste des avis</h3>
    <table>
    {% for review in this_movie_info.reviews %}
            <tr>
                <td>{{ review.WatchedAt|date('d-m-Y') }}</td>
                <td>{{ review.Username }}</td>
                <td>{{ review.Email }}</td>
                <td>{{ review.Content }}</td>
                <td>{{ review.Rating }}</td>
                <td>{{ review.Reactions|join(' / ') }}</td>
            </tr>
    {% endfor %}
  </table>
</div>

{% endblock %}